<html>
  <head>
    <meta charset="UTF-8">
    <title>1. 什么是Redis - Redis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css\bootstrap.min.css">
    <link rel="stylesheet" href="css\font-awesome.min.css">
    <link rel="stylesheet" href="css\highlight.css">
    <link rel="stylesheet" href="css\style.css">
    <link rel="stylesheet" href="css\my.css">
  </head>
  <body>
    <div class="wrapper">
      <div class="header">
        <i class="fa fa-bars sidebar-toggle"></i>
        <span class="title"><a href="index.html">Redis</a></span>
      </div>
      <div class="sidebar">
        <ul>
          <li class="numbered visible"><a href="index.html" data-alt-hash="redis"><span class="number">1.</span>什么是Redis</a></li>
          <li class="numbered visible"><a href="index.html#id-a3c372833dac039aea80c1d4415bb68fe2957991"><span class="number">2.</span>特点</a></li>
          <li class="numbered visible"><a href="index.html#id-4bbe706f8d37e1c435c35707079c83dcc3abd20d"><span class="number">3.</span>优势</a></li>
          <li class="numbered visible"><a href="index.html#bsd"><span class="number">4.</span>BSD协议</a></li>
          <li class="numbered visible"><a href="index.html#id-dc0f5286feb39adc78af028a4859a66877172cc7"><span class="number">5.</span>安装/运行</a></li>
          <li class="numbered visible"><a href="index.html#id-d7d7ce790b9a0b4205cdc6c126559ddea0b33b3b"><span class="number">6.</span>配置</a></li>
          <li class="numbered visible">
            <a href="index.html#id-b031dc9a850704aff9e40e8f5fc968bd9b4354c5"><span class="number">7.</span>数据类型</a>
            <ul>
              <li class="numbered visible"><a href="index.html#string"><span class="number">7.1.</span>String</a></li>
              <li class="numbered visible"><a href="index.html#hash"><span class="number">7.2.</span>Hash</a></li>
              <li class="numbered visible"><a href="index.html#list"><span class="number">7.3.</span>List</a></li>
              <li class="numbered visible"><a href="index.html#set"><span class="number">7.4.</span>Set</a></li>
              <li class="numbered visible"><a href="index.html#zset"><span class="number">7.5.</span>zset</a></li>
            </ul>
          </li>
          <li class="numbered visible">
            <a href="index.html#id-982184ef37aa48284b75af6fef62b493ddf8b295"><span class="number">8.</span>Redis常用操作</a>
            <ul>
              <li class="numbered visible"><a href="index.html#id-03375632728ad9fd3e2ba5efaca86f0a6c9c8d6a"><span class="number">8.1.</span>连接</a></li>
              <li class="numbered visible"><a href="index.html#key"><span class="number">8.2.</span>key相关</a></li>
              <li class="numbered visible"><a href="index.html#id-4c0537bbdbfc1403bd2b65a8560890ff8c9778cd"><span class="number">8.3.</span>String相关</a></li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="content">
        <div class="content-handle"></div>
        <div class="content-container">
          <div class="content-nav content-nav-top">
          </div>
          <div class="page-toc">
            <ul>
              <li class="numbered visible"><a href="#redis"><span class="number">1.</span>什么是Redis</a></li>
              <li class="numbered visible"><a href="#id-a3c372833dac039aea80c1d4415bb68fe2957991"><span class="number">2.</span>特点</a></li>
              <li class="numbered visible"><a href="#id-4bbe706f8d37e1c435c35707079c83dcc3abd20d"><span class="number">3.</span>优势</a></li>
              <li class="numbered visible"><a href="#bsd"><span class="number">4.</span>BSD协议</a></li>
              <li class="numbered visible"><a href="#id-dc0f5286feb39adc78af028a4859a66877172cc7"><span class="number">5.</span>安装/运行</a></li>
              <li class="numbered visible"><a href="#id-d7d7ce790b9a0b4205cdc6c126559ddea0b33b3b"><span class="number">6.</span>配置</a></li>
              <li class="numbered visible">
                <a href="#id-b031dc9a850704aff9e40e8f5fc968bd9b4354c5"><span class="number">7.</span>数据类型</a>
                <ul>
                  <li class="numbered visible"><a href="#string"><span class="number">7.1.</span>String</a></li>
                  <li class="numbered visible"><a href="#hash"><span class="number">7.2.</span>Hash</a></li>
                  <li class="numbered visible"><a href="#list"><span class="number">7.3.</span>List</a></li>
                  <li class="numbered visible"><a href="#set"><span class="number">7.4.</span>Set</a></li>
                  <li class="numbered visible"><a href="#zset"><span class="number">7.5.</span>zset</a></li>
                </ul>
              </li>
              <li class="numbered visible">
                <a href="#id-982184ef37aa48284b75af6fef62b493ddf8b295"><span class="number">8.</span>Redis常用操作</a>
                <ul>
                  <li class="numbered visible"><a href="#id-03375632728ad9fd3e2ba5efaca86f0a6c9c8d6a"><span class="number">8.1.</span>连接</a></li>
                  <li class="numbered visible"><a href="#key"><span class="number">8.2.</span>key相关</a></li>
                  <li class="numbered visible"><a href="#id-4c0537bbdbfc1403bd2b65a8560890ff8c9778cd"><span class="number">8.3.</span>String相关</a></li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="main-content">
            <h1 id="redis"><span class="number">1.</span>什么是Redis</h1>
            <p>REmote DIctionary Server(Redis)是一个完全开源免费的key-value存储系统。他是一个使用ANSI C语言编写、遵守BSD协议，支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
            <p>它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p>
            <h1 id="id-a3c372833dac039aea80c1d4415bb68fe2957991"><span class="number">2.</span>特点</h1>
            <ul>
              <li>redis具有持久化机制，可以定期将内存中的数据持久化到硬盘上。</li>
              <li>Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储。</li>
              <li>redis具备binlog功能，可以将所有操作写入日志，当redis出现故障，可依照binlog进行数据恢复。</li>
              <li>redis支持virtual memory，可以限定内存使用大小，当数据超过阈值，则通过类似LRU的算法把内存中的最不常用数据保存到硬盘的页面文件中。</li>
              <li>redis原生支持的数据类型更多，使用的想象空间更大。</li>
            </ul>
            <h1 id="id-4bbe706f8d37e1c435c35707079c83dcc3abd20d"><span class="number">3.</span>优势</h1>
            <ul>
              <li>性能极高 – Redis能读的速度是110000次/s,写的速度是81000次/s 。</li>
              <li>丰富的数据类型 – Redis支持二进制案例的 Strings, Lists, Hashes, Sets 及 Ordered Sets 数据类型操作。</li>
              <li>原子 – Redis的所有操作都是原子性的，同时Redis还支持对几个操作全并后的原子性执行。</li>
              <li>丰富的特性 – Redis还支持 publish/subscribe, 通知, key 过期等等特性。</li>
            </ul>
            <blockquote>
              <p>原子性：</p>
              <p>事务，同时成功同时失败的特性称作原子性。</p>
            </blockquote>
            <h1 id="bsd"><span class="number">4.</span>BSD协议</h1>
            <p>BSD开源协议是一个给于使用者很大自由的协议。可以自由的使用，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布。当你发布使用了BSD协议的代码，或者以BSD协议代码为基础做二次开发自己的产品时，需要满足三个条件：</p>
            <ul>
              <li>如果再发布的产品中包含源代码，则在源代码中必须带有原来代码中的BSD协议。</li>
              <li>如果再发布的只是二进制类库/软件，则需要在类库/软件的文档和版权声明中包含原来代码中的BSD协议。</li>
              <li>不可以用开源代码的作者/机构名字和原来产品的名字做市场推广。</li>
            </ul>
            <p>BSD代码鼓励代码共享，但需要尊重代码作者的著作权。BSD由于允许使用者修改和重新发布代码，也允许使用或在BSD代码上开发商业软件发布和销 售，因此是对商业集成很友好的协议。</p>
            <p>很多的公司企业在选用开源产品的时候都首选BSD协议，因为可以完全控制这些第三方的代码，在必要的时候可以修改或者 二次开发。</p>
            <h1 id="id-dc0f5286feb39adc78af028a4859a66877172cc7"><span class="number">5.</span>安装/运行</h1>
            <p><a href="https://github.com/MSOpenTech/redis/releases">https://github.com/MSOpenTech/redis/releases</a></p>
            <p>在命令行执行redis-server [配置文件]即可开启redis服务器</p>
            <p>再打开一个窗口，使用<code>redis-cli.exe -h 127.0.0.1 -p 6379</code>即可连接redis数据库</p>
            <h1 id="id-d7d7ce790b9a0b4205cdc6c126559ddea0b33b3b"><span class="number">6.</span>配置</h1>
            <pre><code class="nohighlight"># 获取指定配置
127.0.0.1:6379&gt; CONFIG GET CONFIG_SETTING_NAME
</code></pre>
            <pre><code class="nohighlight"># 获取所有配置
127.0.0.1:6379&gt; CONFIG GET * 
  1) &quot;dbfilename&quot;
  2) &quot;dump.rdb&quot;
  3) &quot;requirepass&quot;
  4) &quot;&quot;
  5) &quot;masterauth&quot;
  6) &quot;&quot;
  7) &quot;unixsocket&quot;
  8) &quot;&quot;
  9) &quot;logfile&quot;
 10) &quot;&quot;
 11) &quot;pidfile&quot;
 12) &quot;&quot;
 13) &quot;maxmemory&quot;
 14) &quot;0&quot;
 15) &quot;maxmemory-samples&quot;
 16) &quot;5&quot;
 17) &quot;timeout&quot;
 18) &quot;0&quot;
 19) &quot;auto-aof-rewrite-percentage&quot;
 20) &quot;100&quot;
 21) &quot;auto-aof-rewrite-min-size&quot;
 22) &quot;67108864&quot;
 23) &quot;hash-max-ziplist-entries&quot;
 24) &quot;512&quot;
 25) &quot;hash-max-ziplist-value&quot;
 26) &quot;64&quot;
 27) &quot;list-max-ziplist-size&quot;
 28) &quot;-2&quot;
 29) &quot;list-compress-depth&quot;
 30) &quot;0&quot;
 31) &quot;set-max-intset-entries&quot;
 32) &quot;512&quot;
 33) &quot;zset-max-ziplist-entries&quot;
 34) &quot;128&quot;
 35) &quot;zset-max-ziplist-value&quot;
 36) &quot;64&quot;
 37) &quot;hll-sparse-max-bytes&quot;
 38) &quot;3000&quot;
 39) &quot;lua-time-limit&quot;
 40) &quot;5000&quot;
 41) &quot;slowlog-log-slower-than&quot;
 42) &quot;10000&quot;
 43) &quot;latency-monitor-threshold&quot;
 44) &quot;0&quot;
 45) &quot;slowlog-max-len&quot;
 46) &quot;128&quot;
 47) &quot;port&quot;
 48) &quot;6379&quot;
 49) &quot;tcp-backlog&quot;
 50) &quot;511&quot;
 51) &quot;databases&quot;
 52) &quot;16&quot;
 53) &quot;repl-ping-slave-period&quot;
 54) &quot;10&quot;
 55) &quot;repl-timeout&quot;
 56) &quot;60&quot;
 57) &quot;repl-backlog-size&quot;
 58) &quot;1048576&quot;
 59) &quot;repl-backlog-ttl&quot;
 60) &quot;3600&quot;
 61) &quot;maxclients&quot;
 62) &quot;10000&quot;
 63) &quot;watchdog-period&quot;
 64) &quot;0&quot;
 65) &quot;slave-priority&quot;
 66) &quot;100&quot;
 67) &quot;min-slaves-to-write&quot;
 68) &quot;0&quot;
 69) &quot;min-slaves-max-lag&quot;
 70) &quot;10&quot;
 71) &quot;hz&quot;
 72) &quot;10&quot;
 73) &quot;cluster-node-timeout&quot;
 74) &quot;15000&quot;
 75) &quot;cluster-migration-barrier&quot;
 76) &quot;1&quot;
 77) &quot;cluster-slave-validity-factor&quot;
 78) &quot;10&quot;
 79) &quot;repl-diskless-sync-delay&quot;
 80) &quot;5&quot;
 81) &quot;tcp-keepalive&quot;
 82) &quot;0&quot;
 83) &quot;cluster-require-full-coverage&quot;
 84) &quot;yes&quot;
 85) &quot;no-appendfsync-on-rewrite&quot;
 86) &quot;no&quot;
 87) &quot;slave-serve-stale-data&quot;
 88) &quot;yes&quot;
 89) &quot;slave-read-only&quot;
 90) &quot;yes&quot;
 91) &quot;stop-writes-on-bgsave-error&quot;
 92) &quot;yes&quot;
 93) &quot;daemonize&quot;
 94) &quot;no&quot;
 95) &quot;rdbcompression&quot;
 96) &quot;yes&quot;
 97) &quot;rdbchecksum&quot;
 98) &quot;yes&quot;
 99) &quot;activerehashing&quot;
100) &quot;yes&quot;
101) &quot;protected-mode&quot;
102) &quot;yes&quot;
103) &quot;repl-disable-tcp-nodelay&quot;
104) &quot;no&quot;
105) &quot;repl-diskless-sync&quot;
106) &quot;no&quot;
107) &quot;aof-rewrite-incremental-fsync&quot;
108) &quot;yes&quot;
109) &quot;aof-load-truncated&quot;
110) &quot;yes&quot;
111) &quot;maxmemory-policy&quot;
112) &quot;noeviction&quot;
113) &quot;loglevel&quot;
114) &quot;notice&quot;
115) &quot;supervised&quot;
116) &quot;no&quot;
117) &quot;appendfsync&quot;
118) &quot;everysec&quot;
119) &quot;appendonly&quot;
120) &quot;no&quot;
121) &quot;dir&quot;
122) &quot;O:\\Development\\Redis-x64-3.2.100&quot;
123) &quot;save&quot;
124) &quot;jd 900 jd 300 jd 60&quot;
125) &quot;client-output-buffer-limit&quot;
126) &quot;normal 0 0 0 slave 268435456 67108864 60 pubsub 33554432 8388608 60&quot;
127) &quot;unixsocketperm&quot;
128) &quot;0&quot;
129) &quot;slaveof&quot;
130) &quot;&quot;
131) &quot;notify-keyspace-events&quot;
132) &quot;&quot;
133) &quot;bind&quot;
134) &quot;127.0.0.1&quot;
</code></pre>
            <pre><code class="nohighlight"># 修改指定配置
127.0.0.1:6379&gt; CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE
</code></pre>
            <pre><code class="nohighlight"># 实例
127.0.0.1:6379&gt; CONFIG SET loglevel &quot;notice&quot;
OK
 CONFIG GET loglevel
1) &quot;loglevel&quot;
2) &quot;notice&quot;
</code></pre>
            <pre><code class="nohighlight">redis.conf 配置项说明如下：
1. Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程
    daemonize no
2. 当Redis以守护进程方式运行时，Redis默认会把pid写入/var/run/redis.pid文件，可以通过pidfile指定
    pidfile /var/run/redis.pid
3. 指定Redis监听端口，默认端口为6379，作者在自己的一篇博文中解释了为什么选用6379作为默认端口，因为6379在手机按键上MERZ对应的号码，而MERZ取自意大利歌女Alessia Merz的名字
    port 6379
4. 绑定的主机地址
    bind 127.0.0.1
5.当 客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能
    timeout 300
6. 指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose
    loglevel verbose
7. 日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null
    logfile stdout
8. 设置数据库的数量，默认数据库为0，可以使用SELECT &lt;dbid&gt;命令在连接上指定数据库id
    databases 16
9. 指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合
    save &lt;seconds&gt; &lt;changes&gt;
    Redis默认配置文件中提供了三个条件：
    save 900 1
    save 300 10
    save 60 10000
    分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。
 
10. 指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大
    rdbcompression yes
11. 指定本地数据库文件名，默认值为dump.rdb
    dbfilename dump.rdb
12. 指定本地数据库存放目录
    dir ./
13. 设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步
    slaveof &lt;masterip&gt; &lt;masterport&gt;
14. 当master服务设置了密码保护时，slav服务连接master的密码
    masterauth &lt;master-password&gt;
15. 设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH &lt;password&gt;命令提供密码，默认关闭
    requirepass foobared
16. 设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息
    maxclients 128
17. 指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，会把Key存放内存，Value会存放在swap区
    maxmemory &lt;bytes&gt;
18. 指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no
    appendonly no
19. 指定更新日志文件名，默认为appendonly.aof
     appendfilename appendonly.aof
20. 指定更新日志条件，共有3个可选值： 
    no：表示等操作系统进行数据缓存同步到磁盘（快） 
    always：表示每次更新操作后手动调用fsync()将数据写到磁盘（慢，安全） 
    everysec：表示每秒同步一次（折衷，默认值）
    appendfsync everysec
 
21. 指定是否启用虚拟内存机制，默认值为no，简单的介绍一下，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中（在后面的文章我会仔细分析Redis的VM机制）
     vm-enabled no
22. 虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享
     vm-swap-file /tmp/redis.swap
23. 将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据 就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0
     vm-max-memory 0
24. Redis swap文件分成了很多的page，一个对象可以保存在多个page上面，但一个page上不能被多个对象共享，vm-page-size是要根据存储的 数据大小来设定的，作者建议如果存储很多小对象，page大小最好设置为32或者64bytes；如果存储很大大对象，则可以使用更大的page，如果不 确定，就使用默认值
     vm-page-size 32
25. 设置swap文件中的page数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，，在磁盘上每8个pages将消耗1byte的内存。
     vm-pages 134217728
26. 设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4
     vm-max-threads 4
27. 设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启
    glueoutputbuf yes
28. 指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法
    hash-max-zipmap-entries 64
    hash-max-zipmap-value 512
29. 指定是否激活重置哈希，默认为开启（后面在介绍Redis的哈希算法时具体介绍）
    activerehashing yes
30. 指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件
    include /path/to/local.conf
</code></pre>
            <h1 id="id-b031dc9a850704aff9e40e8f5fc968bd9b4354c5"><span class="number">7.</span>数据类型</h1>
            <p>Redis五大数据类型：</p>
            <ul>
              <li>String</li>
              <li>Hash</li>
              <li>List</li>
              <li>Set</li>
              <li>zset</li>
            </ul>
            <h2 id="string"><span class="number">7.1.</span>String</h2>
            <p>string是redis最基本的类型，一个key对应一个value。</p>
            <p>string类型是二进制安全的。意思是redis的string可以包含任何数据。比如jpg图片或者序列化的对象 。</p>
            <p>string类型是Redis最基本的数据类型，一个键最大能存储512MB。</p>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; set name &quot;feathers&quot;
OK
127.0.0.1:6379&gt; get name
&quot;feathers&quot;
</code></pre>
            <h2 id="hash"><span class="number">7.2.</span>Hash</h2>
            <p>Redis hash 是一个键名对集合。</p>
            <p>Redis hash是一个string类型的field和value的映射表，hash特别**适合用于存储对象**。</p>
            <pre><code class="nohighlight">hmset key field value [field value ...]
</code></pre>
            <pre><code class="nohighlight"># 存入一个key为user:1的user对象
127.0.0.1:6379&gt; hmset user:1 username feathers password feathers points 200
OK
127.0.0.1:6379&gt; hgetall user:1
1) &quot;username&quot;
2) &quot;feathers&quot;
3) &quot;password&quot;
4) &quot;feathers&quot;
5) &quot;points&quot;
6) &quot;200&quot;
</code></pre>
            <h2 id="list"><span class="number">7.3.</span>List</h2>
            <p>列表，Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</p>
            <pre><code class="nohighlight"># 定义一个key为a的list列表，向里面push元素，并输出
127.0.0.1:6379&gt; lpush a 1
(integer) 1
127.0.0.1:6379&gt; lpush a 5
(integer) 2
127.0.0.1:6379&gt; lpush a 2
(integer) 3
127.0.0.1:6379&gt; lrange a
(error) ERR wrong number of arguments for &#39;lrange&#39; command
127.0.0.1:6379&gt; lrange a 0 10
1) &quot;2&quot;
2) &quot;5&quot;
3) &quot;1&quot;
</code></pre>
            <h2 id="set"><span class="number">7.4.</span>Set</h2>
            <p>集合，Redis的Set是string类型的无序集合。集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。</p>
            <pre><code class="nohighlight">sadd key member [member ...]
</code></pre>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; sadd c redis mongdb memecached
(integer) 3
127.0.0.1:6379&gt; smembers c
1) &quot;redis&quot;
2) &quot;memecached&quot;
3) &quot;mongdb&quot;
127.0.0.1:6379&gt;
</code></pre>
            <h2 id="zset"><span class="number">7.5.</span>zset</h2>
            <p>有序集合，sorted set，注意，zset 和 set 一样也是string类型元素的集合,且不允许重复的成员。</p>
            <pre><code class="nohighlight">zadd key [NX|XX] [CH] [INCR] score member [score member ...]
</code></pre>
            <pre><code class="nohighlight"># 实例
127.0.0.1:6379&gt; zadd d 0 redis
(integer) 1
127.0.0.1:6379&gt; zadd d 0 mongodb
(integer) 1
127.0.0.1:6379&gt; zadd d 0 memcached
(integer) 1
127.0.0.1:6379&gt; zrangebyscore d 0 1000
1) &quot;memcached&quot;
2) &quot;mongodb&quot;
3) &quot;redis&quot;
</code></pre>
            <h1 id="id-982184ef37aa48284b75af6fef62b493ddf8b295"><span class="number">8.</span>Redis常用操作</h1>
            <h2 id="id-03375632728ad9fd3e2ba5efaca86f0a6c9c8d6a"><span class="number">8.1.</span>连接</h2>
            <pre><code class="nohighlight">redis-cli -h host -p port -a &quot;password&quot;
</code></pre>
            <h2 id="key"><span class="number">8.2.</span>key相关</h2>
            <p>存储一个key为name值value为Feathers的值</p>
            <pre><code class="r">redis 127.0.0.1:6379&gt; set name Feathers
OK
</code></pre>
            <p>获取一个值</p>
            <pre><code class="nohighlight">redis 127.0.0.1:6379&gt; get name
&quot;Feathers&quot;
</code></pre>
            <p>序列化某一个值</p>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; dump name
&quot;\x00\bFeathers\a\x00r\xbd\xf0\xd9|\xb6/\x86&quot;
</code></pre>
            <p>删除一个值</p>
            <pre><code class="nohighlight">redis 127.0.0.1:6379&gt; del name
(integer) 1
</code></pre>
            <p>判断是否存在该key</p>
            <pre><code class="nohighlight">redis 127.0.0.1:6379&gt; exists name
(integer) 0
</code></pre>
            <p>设置key的有效期为100秒</p>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; expire name 100
(integer) 1
</code></pre>
            <p>设置key的有效期截止到Unix时间戳</p>
            <pre><code class="nohighlight">redis 127.0.0.1:6379&gt; EXPIREAT w3ckey 1293840000
(integer) 1
</code></pre>
            <p>设置key的有效期为1000毫秒</p>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; pexpire name 1000
(integer) 1
</code></pre>
            <p>查看key的有效期</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; ttl name   /  pttl  name
(integer) -1  // key存在，没有设置剩余时间
(integer) -2  // key不存在，或者已经过期
</code></pre>
            <p>移除key的过期时间</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; set name feathers   // 设置一个key为name的值
OK
127.0.0.1:6379[1]&gt; expire name 100 // 设置过期时间 100 s
(integer) 1
127.0.0.1:6379[1]&gt; ttl name  // 查看name的剩余时间 84s
(integer) 84
127.0.0.1:6379[1]&gt; persist name  // 移除key的过期时间
(integer) 1
127.0.0.1:6379[1]&gt; ttl name  // 查看key的剩余时间 -1代表永久有效
(integer) -1
127.0.0.1:6379[1]&gt; ttl nannnn  // 查看一个不存在的key  -2 代表已过期
(integer) -2
</code></pre>
            <p>查找所有给定给定模式pattern的key</p>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; set book_name APPDevolp
OK
127.0.0.1:6379&gt; set book_price 12.5
OK
127.0.0.1:6379&gt; set book_category study
OK
127.0.0.1:6379&gt; keys book_*
1) &quot;book_category&quot;
2) &quot;book_name&quot;
3) &quot;book_price&quot;
</code></pre>
            <p>将当前数据库的 key 移动到给定的数据库 db 当中</p>
            <pre><code class="nohighlight">127.0.0.1:6379&gt; select 0   // 默认使用数据库0
OK
127.0.0.1:6379&gt; set name feathers // 添加一个key为name的数据
OK
127.0.0.1:6379&gt; move name 1  // 将数据移动到数据库1
(integer) 1
127.0.0.1:6379&gt; exists name  // 数据库0种无name了
(integer) 0
127.0.0.1:6379&gt; select 1  // 切换到数据库1
OK
127.0.0.1:6379[1]&gt; exists name  // name被移动到数据库1中了
(integer) 1
</code></pre>
            <p>从当前数据库中随机返回一个key</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; randomkey
&quot;name&quot;
</code></pre>
            <p>修改key的名称</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; rename name lastname
OK
127.0.0.1:6379[1]&gt; get name
(nil)
127.0.0.1:6379[1]&gt; get lastname
&quot;feathers&quot;
</code></pre>
            <p>修改key的名称，新的名称如果存在，则失败</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; set name feathers
OK
127.0.0.1:6379[1]&gt; set lastname sx
OK
127.0.0.1:6379[1]&gt; renamenx name lastname   // 修改失败
(integer) 0
127.0.0.1:6379[1]&gt; get name
&quot;feathers&quot;
127.0.0.1:6379[1]&gt; get lastname
&quot;sx&quot;
</code></pre>
            <p>查看key对应的value的类型</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; set testType 120.8
OK
127.0.0.1:6379[1]&gt; type testType
string
</code></pre>
            <h2 id="id-4c0537bbdbfc1403bd2b65a8560890ff8c9778cd"><span class="number">8.3.</span>String相关</h2>
            <p>添加一个值为字符串类型的记录</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; set name feathers
OK
127.0.0.1:6379[1]&gt; type name
string
127.0.0.1:6379[1]&gt; set age &quot;23&quot;
OK
127.0.0.1:6379[1]&gt; type age
string
</code></pre>
            <p>获取字符串,字符串会使用双引号包裹</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; get name
&quot;feathers&quot;
127.0.0.1:6379[1]&gt; get age
&quot;23&quot;
</code></pre>
            <p>返回字符串的子串</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; getrange name 0 2
&quot;fea&quot;
</code></pre>
            <p>重新设置value的值，并返回旧值</p>
            <pre><code class="nohighlight">127.0.0.1:6379[1]&gt; getset name lisi
&quot;feathers&quot;
</code></pre>
          </div>
          <div class="content-nav content-nav-bottom">
          </div>
          <div class="footer">
            <p class="credit text-muted">Powered by <a href="https://github.com/kobo/gaiden">Gaiden</a></p>
          </div>
        </div>
      </div>
    </div>
    <script src="js\jquery-2.1.1.min.js"></script>
    <script src="js\highlight.js"></script>
    <script src="js\application.js"></script>
    <script src="js\my.js"></script>
  </body>
</html>
